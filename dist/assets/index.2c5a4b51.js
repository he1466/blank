var T=Object.defineProperty;var L=(e,t,s)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var g=(e,t,s)=>(L(e,typeof t!="symbol"?t+"":t,s),s);import{_ as u,E as w}from"./jspdf.0b42b4d1.js";import{t as P}from"./config.a0664ad4.js";import{r as A}from"./element-plus.c24761e2.js";import D from"./html2canvas.4d0ab5af.js";import{s as b,e as v}from"./index.7185b8a9.js";const C=(e,t)=>{const s=e[t];return s?typeof s=="function"?s():Promise.resolve(s):new Promise((o,l)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(l.bind(null,new Error("Unknown variable dynamic import: "+t)))})};async function $(e){return(await C(Object.assign({"../../templates/business/style.scss":()=>u(()=>Promise.resolve({}),["./style.55d7f298.css"],import.meta.url),"../../templates/concise/style.scss":()=>u(()=>Promise.resolve({}),["./style.8211914a.css"],import.meta.url),"../../templates/create/style.scss":()=>u(()=>Promise.resolve({}),["./style.30a0cd92.css"],import.meta.url),"../../templates/fresh/style.scss":()=>u(()=>Promise.resolve({}),["./style.4360e96f.css"],import.meta.url),"../../templates/front_end/style.scss":()=>u(()=>Promise.resolve({}),["./style.8fdab5df.css"],import.meta.url),"../../templates/geek/style.scss":()=>u(()=>Promise.resolve({}),["./style.6efe79b4.css"],import.meta.url),"../../templates/general/style.scss":()=>u(()=>Promise.resolve({}),["./style.86f71d3a.css"],import.meta.url),"../../templates/graduation_reexam/style.scss":()=>u(()=>Promise.resolve({}),["./style.aa357dd8.css"],import.meta.url),"../../templates/internet/style.scss":()=>u(()=>Promise.resolve({}),["./style.30ddf51a.css"],import.meta.url),"../../templates/internet_avatar/style.scss":()=>u(()=>Promise.resolve({}),["./style.35250429.css"],import.meta.url),"../../templates/internet_social/style.scss":()=>u(()=>Promise.resolve({}),["./style.0343bb9d.css"],import.meta.url),"../../templates/operation/style.scss":()=>u(()=>Promise.resolve({}),["./style.2366b17b.css"],import.meta.url),"../../templates/operation_avatar/style.scss":()=>u(()=>Promise.resolve({}),["./style.492d19b3.css"],import.meta.url),"../../templates/simple_avatar/style.scss":()=>u(()=>Promise.resolve({}),["./style.eac5aea9.css"],import.meta.url)}),`../../templates/${e}/style.scss`)).default}const H=e=>{for(const t of P)if(e===t.type)return t.content;return""},q={h1:{max:30,min:-15,top:0,tag:"",optimal:0},h2:{max:30,min:-15,top:0,tag:"",optimal:0},h3:{max:20,min:-15,top:0,tag:"",optimal:0},h4:{max:20,min:-15,top:0,tag:"",optimal:0},h5:{max:20,min:-15,top:0,tag:"",optimal:0},h6:{max:20,min:-15,top:0,tag:"",optimal:0},li:{max:10,min:-15,top:0,tag:"",optimal:0},p:{max:10,min:-15,top:0,tag:"",optimal:0}},I=(e,t)=>e.optimal>t.optimal,d=(e,t,s)=>[e[t],e[s]]=[e[s],e[t]];class z{constructor(t){g(this,"container",[]);g(this,"cmp",I);this.cmp=t}push(t){const{container:s,cmp:o}=this;s.push(t);let l=s.length-1;for(;l;){const a=Math.floor((l-1)/2);if(!o(s[l],s[a]))return;d(s,l,a),l=a}}pop(){const{container:t,cmp:s}=this;if(!t.length)return null;d(t,0,t.length-1);const o=t.pop(),l=t.length;let a=0,i=a*2+1;for(;i<l;){const n=a*2+2;if(n<l&&s(t[n],t[i])&&(i=n),!s(t[i],t[a]))break;d(t,i,a),a=i,i=a*2+1}return o}top(){return this.container.length?this.container[0]:null}isEmpty(){return this.container.length===0}}function G(){return document.createElement("style")}function U(){return document.createElement("div")}function O(e){return document.head.querySelector(`style[${e}]`)}function j(e){var t;(t=O(e))==null||t.remove()}function x(e){return e.match(/\d+/g).map(s=>parseInt(s))}function J(e,t){const{showLoading:s,closeLoading:o}=F();s("\u6B63\u5728\u5BFC\u51FAPDF \u8BF7\u8010\u5FC3\u7B49\u5F85...");const l=getComputedStyle(t).getPropertyValue("background-color"),[a,i,n]=x(l);D(t,{allowTaint:!1,logging:!1,useCORS:!0,scale:4,backgroundColor:l}).then(c=>{var y;const r=new w("p","mm","a4");r.setFillColor(a,i,n),r.rect(0,0,r.internal.pageSize.width,r.internal.pageSize.height,"F");const m=c.getContext("2d"),h=210,E=297,_=Math.floor(E*c.width/h);let p=0;for(;p<c.height;){const f=document.createElement("canvas");f.width=c.width,f.height=Math.min(_,c.height-p),(y=f.getContext("2d"))==null||y.putImageData(m==null?void 0:m.getImageData(0,p,c.width,Math.min(_,c.height-p)),0,0),r.addImage(f.toDataURL("image/jpeg",1),"JPEG",0,0,h,Math.min(E,h*f.height/f.width)),p+=_,c.height-p>1&&(r.addPage(),r.setFillColor(a,i,n),r.rect(0,0,r.internal.pageSize.width,r.internal.pageSize.height,"F"))}r.save(`${e}.pdf`),b("PDF\u5BFC\u51FA\u6210\u529F")}).catch(c=>{v("\u5BFC\u51FA\u5931\u8D25, "+c)}).finally(o)}function F(){let e=null;function t(o){e=A.service({lock:!0,text:o,background:"rgba(0, 0, 0, 0.7)"})}function s(){e&&e.close()}return{showLoading:t,closeLoading:s}}function K(e=0){const t=document.documentElement||document.body;let s=Math.abs(t.scrollTop-e)/20,o=0,l=-1;const a=s;function i(){o=t.scrollTop;const n=o-e;l==o||n==0||(l=o,window.requestAnimationFrame(function(){if(s=n>0?a:-a,o-=s,Math.abs(n)<a){t.scrollTop=e;return}t.scrollTop=o,Math.abs(n)>0&&i()}))}i()}function Q(e){let t=e==null?void 0:e.offsetTop,s=e==null?void 0:e.offsetParent;for(;s!==null;)t+=s.offsetTop,s=s.offsetParent;return t}function R({node:e,latest:t,uid:s}){var l,a;let o="";if(e.nodeType===Node.ELEMENT_NODE){const i=e.classList,n=e.tagName.toLowerCase();i.contains("flex-layout")?o+=`
::: start
`:i.contains("iconfont")?o+=`icon:${i[1].slice(5)} `:i.contains("head-layout")?o+=`
::: headStart
`:n==="a"?o+="[":["b","strong"].includes(n)?o+="**":n[0]==="h"?o+="#".repeat(+n[1])+" ":n==="li"?o+=`${((l=e.parentElement)==null?void 0:l.tagName.toLowerCase())=="ul"?"- ":s+". "}`:["td","th"].includes(n)?o+="| ":n==="code"?o+="`":n==="i"&&i[0]!="iconfont"?o+="*":n==="br"&&(o+="&nbsp;");const c=e.childNodes;for(let r=0;r<c.length;r++){const m=c[r].nodeType==c[r].ELEMENT_NODE&&((a=c[r].parentElement)==null?void 0:a.tagName.toLowerCase())=="ol";o+=R({node:c[r],latest:r===c.length-1,uid:m?++s:0})}if(i.contains("flex-layout"))o+="::: end";else if(i.contains("head-layout"))o+="::: headEnd";else if(i.contains("flex-layout-item")&&!t)o+=`
:::`;else if(n=="a")o+=`](${e.getAttribute("href")})`;else if(["b","strong"].includes(n))o+="**";else if(n=="img"){const r=e.alt,m=r==null?void 0:r.includes("\u4E2A\u4EBA\u5934\u50CF");o+=`![${m?"\u4E2A\u4EBA\u5934\u50CF":r}](${e.src})`}else n==="tr"?o+="|":["th","td"].includes(n)?o+=" ":n==="code"?o+="`":n==="i"&&i[0]!="iconfont"&&(o+="*");["b","span","strong","a","i","td","th","thead","code","ul","ol"].includes(n)||(o+=`
`)}else{const i=e.textContent||"";o+=i}return o}export{z as H,G as a,U as b,Q as c,J as d,R as e,H as g,$ as i,q as o,O as q,j as r,K as s};
